{"title":"配置Wordpress使网站强制HTTPS访问","uid":"c24bf6860b3681d01b2e59b76b535050","slug":"wordpress-https","date":"2016-01-26T02:37:41.000Z","updated":"2021-04-11T09:44:33.294Z","comments":true,"path":"api/articles/wordpress-https.json","keywords":"逃跑计划,Blog,Developer,Front-end,前端,Apple,小技巧","cover":"https://cdn.blog.hopenet.tech/thumbnail/wordpress-https.png","content":"<p>HTTPS协议越来越普及，Google、百度等搜索引擎也大大地对HTTPS增加友好度各大网站也开启了全站SSL，比如淘宝、百度等，也意味着互联网HTTPS时代的到来。</p>\n<p>为了跟上互联网时代的热潮，大家跟我一起来简单的配置即可开启全站HTTPS强制访问！</p>\n<span id=\"more\"></span>\n\n<hr>\n<p>1.将配置好的SSL证书添加到服务器/面板，并手动输入：https://你的网站/</p>\n<p>2.进入WP后台，进入设置-常规 将WordPress地址（URL）、站点地址（URL）两项修改为：https</p>\n<p>3.修改config.php文件，在末尾添加代码</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token comment\">/* 强制后台和登录使用 SSL */</span>\n<span class=\"token function\">define</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'FORCE_SSL_LOGIN'</span><span class=\"token punctuation\">,</span> <span class=\"token constant boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">define</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'FORCE_SSL_ADMIN'</span><span class=\"token punctuation\">,</span> <span class=\"token constant boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<p>修改完成后你会发现打开网站后，进入文章、后台，已经自动帮你跳转到https了</p>\n<p>4.既然修改了网址，那最基本的图片也要让它变成https！</p>\n<p>在function.php文件末尾处添加代码：</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\"><span class=\"token comment\">/* 替换图片链接为 https */</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">my_content_manipulator</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$content</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span> <span class=\"token function\">is_ssl</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span>\n        <span class=\"token variable\">$content</span> <span class=\"token operator\">=</span> <span class=\"token function\">str_replace</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'http://cehu.top/wp-content/uploads'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'https://cehu.top/wp-content/uploads'</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$content</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">&#125;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token variable\">$content</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span>\n<span class=\"token function\">add_filter</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'the_content'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'my_content_manipulator'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n`<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>将代码上的cehu.top修改为你的域名</p>\n<p>5.配置.htaccess文件，使网站301重定向到HTTPS (注意！这个操作会使网站无法正常访问http)</p>\n<p>在你博客空间的www目录（有的可能是 public_html）下，找到.htaccess文件，编辑它，在里边填入下列代码：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">#网站定制化开启 HTTPS 的301重定向\n&lt;IfModule mod_rewrite.c&gt;\nRewriteEngine On\nRewriteCond %&#123;HTTPS&#125; !^on$ [NC]\nRewriteRule (.*) https:&#x2F;&#x2F;%&#123;SERVER_NAME&#125;%&#123;REQUEST_URI&#125; [L,R&#x3D;301]\nRewriteBase &#x2F;\nRewriteRule ^index\\.php$ - [L]\nRewriteCond %&#123;REQUEST_FILENAME&#125; !-f\nRewriteCond %&#123;REQUEST_FILENAME&#125; !-d\nRewriteRule . &#x2F;index.php [L]\n&lt;&#x2F;IfModule&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>ls -a 即可看到.htaccess文件</p>\n<p>一切皆以完成！</p>\n","feature":null,"text":"HTTPS协议越来越普及，Google、百度等搜索引擎也大大地对HTTPS增加友好度各大网站也开启了全站SSL，比如淘宝、百度等，也意味着互联网HTTPS时代的到来。 为了跟上互联网时代的热潮，大家跟我一起来简单的配置即可开启全站HTTPS强制访问！ 1.将配置好的SSL证书添加...","link":"","photos":[],"count_time":{"symbolsCount":"1.3k","symbolsTime":"1 mins."},"categories":[{"name":"技术栈","slug":"技术栈","count":2,"path":"api/categories/技术栈.json"}],"tags":[{"name":"WordPress","slug":"WordPress","count":2,"path":"api/tags/WordPress.json"},{"name":"HTTPS","slug":"HTTPS","count":1,"path":"api/tags/HTTPS.json"}],"toc":"","author":{"name":"Andy","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"","description":"愿风指引着你的道路，愿你的刀刃永远锋利","socials":{"github":"https://github.com/liwuxi","twitter":"https://twitter.com/imwuxi","stackoverflow":"","wechat":"","qq":"","weibo":"https://www.weibo.com/imlevis","zhihu":"","csdn":"","juejin":""}},"mapped":true,"prev_post":{"title":"Mail函数禁用下添加WordPress评论回复邮件通知","uid":"c87e7ce638abc19774c3ede9965f3d29","slug":"wordpress-email","date":"2016-08-03T07:38:19.000Z","updated":"2021-04-11T09:44:33.294Z","comments":true,"path":"api/articles/wordpress-email.json","keywords":"逃跑计划,Blog,Developer,Front-end,前端,Apple,小技巧","cover":"https://cdn.blog.hopenet.tech/thumbnail/smtp-email.png","text":"本次教程利用插件在虚拟主机 Or VPS 在 Mail 函数被禁用的情况下，添加WordPress评论回复邮件通知功能，更好的对用户进行交流。 自己折腾了好久，一直Google不出一个心目中完美的解决方案 只能借助插件，WP-Mail-SMTP ，插件作者：Callum Macd...","link":"","photos":[],"count_time":{"symbolsCount":"4.8k","symbolsTime":"4 mins."},"categories":[{"name":"技术栈","slug":"技术栈","count":2,"path":"api/categories/技术栈.json"}],"tags":[{"name":"WordPress","slug":"WordPress","count":2,"path":"api/tags/WordPress.json"},{"name":"Mail","slug":"Mail","count":1,"path":"api/tags/Mail.json"}],"author":{"name":"Andy","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"","description":"愿风指引着你的道路，愿你的刀刃永远锋利","socials":{"github":"https://github.com/liwuxi","twitter":"https://twitter.com/imwuxi","stackoverflow":"","wechat":"","qq":"","weibo":"https://www.weibo.com/imlevis","zhihu":"","csdn":"","juejin":""}}},"next_post":{"title":"极致好用！一款开源的VestaCP面板","uid":"329b7a09562d564b19523b67f5be120b","slug":"vestacp","date":"2016-01-16T08:33:44.000Z","updated":"2021-04-11T09:44:33.294Z","comments":true,"path":"api/articles/vestacp.json","keywords":"逃跑计划,Blog,Developer,Front-end,前端,Apple,小技巧","cover":"https://cdn.blog.hopenet.tech/thumbnail/vests.png","text":"VestaCP是由俄罗斯的人编写的VPS主机控制面板，支持中文，Vestacp功能强大，基本上已经和Cpanel看齐。支持Apache、Nginx、Bind、Exim、Dovecot、vsftpd、MySQL等，提供可视化的网站管理面板，非常适合新手用户使用。 什么是VestaC...","link":"","photos":[],"count_time":{"symbolsCount":"1k","symbolsTime":"1 mins."},"categories":[{"name":"测评","slug":"测评","count":2,"path":"api/categories/测评.json"}],"tags":[{"name":"Linux","slug":"Linux","count":1,"path":"api/tags/Linux.json"},{"name":"VPS","slug":"VPS","count":1,"path":"api/tags/VPS.json"},{"name":"面板","slug":"面板","count":1,"path":"api/tags/面板.json"}],"author":{"name":"Andy","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"","description":"愿风指引着你的道路，愿你的刀刃永远锋利","socials":{"github":"https://github.com/liwuxi","twitter":"https://twitter.com/imwuxi","stackoverflow":"","wechat":"","qq":"","weibo":"https://www.weibo.com/imlevis","zhihu":"","csdn":"","juejin":""}}}}